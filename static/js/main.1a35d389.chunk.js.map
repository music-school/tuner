{"version":3,"sources":["utils/globalStyles.js","features/Meter/components/Wrapper.js","features/Meter/components/Point.js","features/Meter/components/PointValue.js","features/Meter/components/Pointer.js","features/Meter/components/Dot.js","features/Meter/Meter.js","components/AppWrapper.js","components/Frequency.js","components/NoteWrapper.js","components/Note.js","components/Octave.js","components/Button.js","utils/index.js","App.js","index.js"],"names":["GlobalStyle","createGlobalStyle","_templateObject","normalize","Wrapper","styled","div","withConfig","displayName","componentId","Point","_ref","isStrong","_ref2","isGreen","_ref3","angle","PointValue","isSmallTopMargin","Pointer","Dot","scalePoints","value","Meter","cents","props","Object","objectWithoutProperties","react_default","a","createElement","isNaN","map","point","index","key","Math","ceil","length","some","i","abs","AppWrapper","Frequency","NoteWrapper","Note","Octave","ButtonWrapper","button","isActive","ButtonContent","Button","_ref4","onClick","noteStrings","getOctave","note","parseInt","getCents","frequency","floor","log","pow","getFrequencyFromNoteNumber","Aubio","window","initialState","octave","isTunerActive","scriptProcessor","audioContext","mediaStreamSource","ReactDOM","render","Fragment","_useState","useState","_useState2","slicedToArray","_useState2$","setState","pitchDetector","audioProcessCallback","e","do","inputBuffer","getChannelData","round","getNote","prevState","objectSpread","toFixed","handleStopTuner","onaudioprocess","mediaStream","stop","useEffect","undefined","navigator","mediaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","Error","Promise","resolve","reject","call","startTuner","AudioContext","webkitAudioContext","getAudioContext","then","aubio","Pitch","sampleRate","audio","stream","createScriptProcessor","createMediaStreamSource","analyser","createAnalyser","fftSize","connect","destination","alert","message","Meter_Meter","Button_Button","document","getElementById"],"mappings":"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","file":"static/js/main.1a35d389.chunk.js","sourcesContent":["import { createGlobalStyle } from \"styled-components\";\nimport { normalize } from \"polished\";\n\nexport const GlobalStyle = createGlobalStyle`\n  ${normalize()}\n\n  html,\n  body {\n    width: 100%;\n  }\n\n  body {\n    background-color: #303030;\n    font-family: Arial, Helvetica, sans-serif\n  }\n`;\n","import styled from \"styled-components/macro\";\n\nexport const Wrapper = styled.div`\n  margin-top: 50px;\n  position: relative;\n  display: flex;\n  width: 500px;\n  height: 250px;\n`;\n","import styled from \"styled-components/macro\";\n\nexport const Point = styled.div`\n  position: absolute;\n  height: 100%;\n  transform-origin: bottom;\n  width: 2px;\n  right: calc(50% - 1px);\n  border-top: ${({ isStrong }) => (isStrong ? 20 : 10)}px solid\n    ${({ isGreen }) => (isGreen ? \"#a9c519\" : \"#b2b2b2\")};\n  transform: rotate(${({ angle }) => angle}deg);\n`;\n","import styled from \"styled-components/macro\";\n\nexport const PointValue = styled.div`\n  position: absolute;\n  top: ${({ isSmallTopMargin }) => (isSmallTopMargin ? -35 : -45)}px;\n  left: 50%;\n  transform: translateX(-50%);\n  color: ${({ isGreen }) => (isGreen ? \"#a9c519\" : \"#b2b2b2\")};\n`;\n","import styled from \"styled-components/macro\";\n\nexport const Pointer = styled.div`\n  position: absolute;\n  height: 100%;\n  transform-origin: bottom;\n  width: 2px;\n  height: calc(100% - 30px);\n  background-color: #266980;\n  bottom: 0;\n  left: 50%;\n  transform: translateX(-50%) rotate(${({ angle }) => angle}deg);\n  z-index: 10;\n  transition: all 0.5s;\n`;\n","import styled from \"styled-components/macro\";\n\nexport const Dot = styled.div`\n  position: absolute;\n  width: 6px;\n  height: 6px;\n  border-radius: 50%;\n  background-color: #266980;\n  bottom: -3px;\n  left: 50%;\n  transform: translateX(-50%);\n`;\n","import React from \"react\";\nimport { Wrapper, Point, PointValue, Pointer, Dot } from \"./components\";\n\nconst scalePoints = [\n  { angle: -45, value: -50 },\n  { angle: -36 },\n  { angle: -27, value: -30 },\n  { angle: -18 },\n  { angle: -9 },\n  { angle: 0, value: 0 },\n  { angle: 9 },\n  { angle: 18 },\n  { angle: 27, value: 30 },\n  { angle: 36 },\n  { angle: 45, value: 50 }\n];\n\nexport const Meter = ({ cents, ...props }) => (\n  <Wrapper {...props}>\n    <Dot />\n    <Pointer angle={isNaN(cents) ? 0 : cents * (90 / 100)} />\n    {scalePoints.map((point, index) => (\n      <Point\n        key={point.angle}\n        angle={point.angle}\n        isStrong={[\n          0,\n          Math.ceil((scalePoints.length - 1) / 2),\n          scalePoints.length - 1\n        ].some(i => i === index)}\n        isGreen={Math.abs(point.angle) === 9 || point.angle === 0}\n      >\n        <PointValue\n          isSmallTopMargin={Math.abs(point.value) === 30}\n          isGreen={point.value === 0}\n        >\n          {point.value}\n        </PointValue>\n      </Point>\n    ))}\n  </Wrapper>\n);\n","import styled from \"styled-components/macro\";\n\nexport const AppWrapper = styled.div`\n  width: 100vw;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`;\n","import styled from \"styled-components/macro\";\n\nexport const Frequency = styled.div`\n  margin-top: 15px;\n  color: #fff;\n  font-size: 22px;\n\n  & > span {\n    color: #93ccbf;\n  }\n`;\n","import styled from \"styled-components/macro\";\n\nexport const NoteWrapper = styled.div`\n  margin-top: 50px;\n  display: flex;\n  justify-content: center;\n  align-items: baseline;\n  color: #fff;\n`;\n","import styled from \"styled-components/macro\";\n\nexport const Note = styled.div`\n  font-size: 96px;\n  line-height: 74px;\n`;\n","import styled from \"styled-components/macro\";\n\nexport const Octave = styled.div`\n  font-size: 46px;\n  line-height: 40px;\n`;\n","import React from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst ButtonWrapper = styled.button`\n  display: flex;\n  justify-content: ${({ isActive }) => (isActive ? \"flex-end\" : \"flex-start\")};\n  align-items: center;\n  width: 100px;\n  height: 50px;\n  margin-top: 40px;\n  border: 0;\n  outline: none;\n  background-color: ${({ isActive }) => (isActive ? \"#93ccbf\" : \"#fff\")};\n  padding: 5px;\n  cursor: pointer;\n  border-radius: 4px;\n`;\n\nconst ButtonContent = styled.div`\n  position: relative;\n  width: 40px;\n  height: 38px;\n  background: ${({ isActive }) => (isActive ? \"#fff\" : \"#93ccbf\")};\n  border-radius: 4px;\n`;\n\nexport const Button = ({ isActive, onClick }) => (\n  <ButtonWrapper isActive={isActive} onClick={onClick}>\n    <ButtonContent isActive={isActive} />\n  </ButtonWrapper>\n);\n","const noteStrings = [\n  \"C\",\n  \"C#\",\n  \"D\",\n  \"D#\",\n  \"E\",\n  \"F\",\n  \"F#\",\n  \"G\",\n  \"G#\",\n  \"A\",\n  \"A#\",\n  \"B\"\n];\n\nexport const getNote = frequency => {\n  const note = 12 * (Math.log(frequency / 440) / Math.log(2));\n  return Math.round(note) + 69;\n};\n\nexport const getNoteString = note => noteStrings[note % 12];\n\nexport const getOctave = note => parseInt(note / 12) - 1;\n\nconst getFrequencyFromNoteNumber = note => 440 * Math.pow(2, (note - 69) / 12);\n\nexport const getCents = (frequency, note) =>\n  Math.floor(\n    (1200 * Math.log(frequency / getFrequencyFromNoteNumber(note))) /\n      Math.log(2)\n  );\n","import React, { useState, useEffect } from \"react\";\n\nimport { Meter } from \"./features/Meter\";\nimport {\n  AppWrapper,\n  Frequency,\n  NoteWrapper,\n  Note,\n  Octave,\n  Button\n} from \"./components\";\n\nimport { getNote, getNoteString, getOctave, getCents } from \"./utils\";\n\nconst Aubio = window.Aubio;\n\nconst getAudioContext = () => {\n  window.AudioContext = window.AudioContext || window.webkitAudioContext;\n\n  if (!window.AudioContext) {\n    throw new Error(\"Web Audio API is not supported in this browser\");\n  }\n\n  return new window.AudioContext();\n};\n\nconst initialState = {\n  note: \"A\",\n  octave: 4,\n  cents: 0,\n  frequency: 440,\n  isTunerActive: false\n};\n\nlet scriptProcessor = null;\n\nlet audioContext = null;\n\nlet mediaStreamSource = null;\n\nexport const App = () => {\n  const [\n    { note, octave, cents, frequency, isTunerActive },\n    setState\n  ] = useState(initialState);\n\n  let pitchDetector = null;\n\n  const initGetUserMedia = () => {\n    if (navigator.mediaDevices === undefined) {\n      navigator.mediaDevices = {};\n    }\n\n    if (navigator.mediaDevices.getUserMedia === undefined) {\n      navigator.mediaDevices.getUserMedia = function(constraints) {\n        const getUserMedia =\n          navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n\n        if (!getUserMedia) {\n          throw new Error(\"getUserMedia is not implemented in this browser\");\n        }\n\n        return new Promise(function(resolve, reject) {\n          getUserMedia.call(navigator, constraints, resolve, reject);\n        });\n      };\n    }\n  };\n\n  const audioProcessCallback = e => {\n    const frequency = pitchDetector.do(e.inputBuffer.getChannelData(0));\n\n    if (frequency) {\n      const note = getNote(frequency);\n      const cents = getCents(frequency, note);\n\n      setState(prevState => ({\n        ...prevState,\n        note: getNoteString(note),\n        octave: getOctave(note),\n        frequency: frequency.toFixed(1),\n        cents\n      }));\n    }\n  };\n\n  const handleStopTuner = () => {\n    setState(initialState);\n\n    if (scriptProcessor) {\n      scriptProcessor.onaudioprocess = null;\n      scriptProcessor = null;\n    }\n\n    if (audioContext) {\n      audioContext = null;\n    }\n\n    if (\n      mediaStreamSource &&\n      mediaStreamSource.mediaStream &&\n      mediaStreamSource.mediaStream.stop\n    ) {\n      mediaStreamSource.mediaStream.stop();\n    }\n  };\n\n  useEffect(() => {\n    initGetUserMedia();\n\n    return () => {\n      handleStopTuner();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const startTuner = () => {\n    try {\n      audioContext = getAudioContext();\n\n      Aubio().then(aubio => {\n        pitchDetector = new aubio.Pitch(\n          \"default\",\n          2048,\n          1,\n          audioContext.sampleRate\n        );\n\n        navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {\n          scriptProcessor = audioContext.createScriptProcessor(2048, 1, 1);\n\n          mediaStreamSource = audioContext.createMediaStreamSource(stream);\n\n          const analyser = audioContext.createAnalyser();\n          analyser.fftSize = 2048;\n          mediaStreamSource.connect(analyser);\n\n          analyser.connect(scriptProcessor);\n\n          scriptProcessor.connect(audioContext.destination);\n\n          scriptProcessor.onaudioprocess = audioProcessCallback;\n        });\n      });\n    } catch (e) {\n      alert(\"Error: \" + e.message);\n    }\n  };\n\n  const handleStartTuner = () => {\n    setState(prevState => ({\n      ...prevState,\n      isTunerActive: true\n    }));\n\n    startTuner();\n  };\n\n  return (\n    <AppWrapper>\n      <Meter cents={cents} />\n      <NoteWrapper>\n        <Note>{note}</Note>\n        <Octave>{octave}</Octave>\n      </NoteWrapper>\n      <Frequency>\n        <span>{frequency}</span> Hz\n      </Frequency>\n      <Button\n        isActive={isTunerActive}\n        onClick={isTunerActive ? handleStopTuner : handleStartTuner}\n      />\n    </AppWrapper>\n  );\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { GlobalStyle } from \"./utils/globalStyles\";\nimport { App } from \"./App\";\n\nReactDOM.render(\n  <>\n    <GlobalStyle />\n    <App />\n  </>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}